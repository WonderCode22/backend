#if ($ctx.error)
  $util.error($ctx.error.message, $ctx.error.type)
#end

#set ($result = {
  'items': [],
  'nextToken': $ctx.prev.result.nextToken
})

#foreach ($post in $ctx.prev.result.items)
  #if ($post.postStatus == 'COMPLETED')
    $util.qr($result.items.add($post))
  #end
#end

{
  "version": "2018-05-29",
  "payload": $util.toJson($result)
}
